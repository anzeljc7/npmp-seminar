<?xml version="1.0" encoding="UTF-8"?>
<sbml xmlns="http://www.sbml.org/sbml/level3/version1/core" level="3" version="1">
  <model id="Coherent_Feedforward_Loop_AND_Gate" name="E. coli CFFL Type 1">
    <notes>
      <body xmlns="http://www.w3.org/1999/xhtml">
        <p>
          This model represents the Coherent Feedforward Loop (Type 1) described in Shen-Orr et al. (2002).
          Transcription factor X regulates Y, and both X and Y jointly regulate Z in an AND-gate configuration.
          (Sources: 82, 118-120, 311).
        </p>
        <p>
          <strong>Functional Behavior:</strong> The circuit acts as a persistence detector. 
          The intermediate Y acts as a delay timer. 
          - Short pulse of X: Y does not reach the threshold; Z is not activated.
          - Persistent pulse of X: Y crosses threshold; X and Y are both present; Z is activated.
        </p>
      </body>
    </notes>

    <listOfCompartments>
      <compartment id="cell" size="1" spatialDimensions="3" constant="true"/>
    </listOfCompartments>

    <listOfSpecies>
      <species id="X" compartment="cell" initialConcentration="0" boundaryCondition="true" constant="false" hasOnlySubstanceUnits="false"/>
      <species id="Y" compartment="cell" initialConcentration="0" boundaryCondition="false" constant="false" hasOnlySubstanceUnits="false"/>
      <species id="Z" compartment="cell" initialConcentration="0" boundaryCondition="false" constant="false" hasOnlySubstanceUnits="false"/>
    </listOfSpecies>

    <listOfParameters>
      <parameter id="beta_y" value="1.0" constant="true"/>
      <parameter id="alpha_y" value="0.5" constant="true"/> <parameter id="beta_z" value="1.0" constant="true"/>
      <parameter id="alpha_z" value="0.5" constant="true"/>
      
      <parameter id="K_xy" value="0.5" constant="true"/> <parameter id="K_xz" value="0.5" constant="true"/> <parameter id="K_yz" value="0.5" constant="true"/> <parameter id="n" value="4.0" constant="true"/>
    </listOfParameters>

    <listOfReactions>
      <reaction id="synthesis_Y" reversible="false" fast="false">
        <listOfProducts>
          <speciesReference species="Y" stoichiometry="1" constant="true"/>
        </listOfProducts>
        <listOfModifiers>
          <modifierSpeciesReference species="X"/>
        </listOfModifiers>
        <kineticLaw>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <times/>
              <ci> beta_y </ci>
              <apply>
                <divide/>
                <apply> <power/> <ci> X </ci> <ci> n </ci> </apply>
                <apply>
                  <plus/>
                  <apply> <power/> <ci> K_xy </ci> <ci> n </ci> </apply>
                  <apply> <power/> <ci> X </ci> <ci> n </ci> </apply>
                </apply>
              </apply>
            </apply>
          </math>
        </kineticLaw>
      </reaction>

      <reaction id="degradation_Y" reversible="false" fast="false">
        <listOfReactants>
          <speciesReference species="Y" stoichiometry="1" constant="true"/>
        </listOfReactants>
        <kineticLaw>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <times/>
              <ci> alpha_y </ci>
              <ci> Y </ci>
            </apply>
          </math>
        </kineticLaw>
      </reaction>

      <reaction id="synthesis_Z" reversible="false" fast="false">
        <listOfProducts>
          <speciesReference species="Z" stoichiometry="1" constant="true"/>
        </listOfProducts>
        <listOfModifiers>
          <modifierSpeciesReference species="X"/>
          <modifierSpeciesReference species="Y"/>
        </listOfModifiers>
        <kineticLaw>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <times/>
              <ci> beta_z </ci>
              <apply>
                <divide/>
                <apply> <power/> <ci> X </ci> <ci> n </ci> </apply>
                <apply>
                  <plus/>
                  <apply> <power/> <ci> K_xz </ci> <ci> n </ci> </apply>
                  <apply> <power/> <ci> X </ci> <ci> n </ci> </apply>
                </apply>
              </apply>
              <apply>
                <divide/>
                <apply> <power/> <ci> Y </ci> <ci> n </ci> </apply>
                <apply>
                  <plus/>
                  <apply> <power/> <ci> K_yz </ci> <ci> n </ci> </apply>
                  <apply> <power/> <ci> Y </ci> <ci> n </ci> </apply>
                </apply>
              </apply>
            </apply>
          </math>
        </kineticLaw>
      </reaction>

      <reaction id="degradation_Z" reversible="false" fast="false">
        <listOfReactants>
          <speciesReference species="Z" stoichiometry="1" constant="true"/>
        </listOfReactants>
        <kineticLaw>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <times/>
              <ci> alpha_z </ci>
              <ci> Z </ci>
            </apply>
          </math>
        </kineticLaw>
      </reaction>
    </listOfReactions>

    <listOfEvents>
      <event id="short_pulse_start" useValuesFromTriggerTime="true">
        <trigger initialValue="false" persistent="true">
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <geq/>
              <csymbol encoding="text" definitionURL="http://www.sbml.org/sbml/symbols/time"> time </csymbol>
              <cn type="integer"> 2 </cn>
            </apply>
          </math>
        </trigger>
        <listOfEventAssignments>
          <eventAssignment variable="X">
            <math xmlns="http://www.w3.org/1998/Math/MathML">
              <cn type="integer"> 1 </cn>
            </math>
          </eventAssignment>
        </listOfEventAssignments>
      </event>

      <event id="short_pulse_end" useValuesFromTriggerTime="true">
        <trigger initialValue="false" persistent="true">
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <geq/>
              <csymbol encoding="text" definitionURL="http://www.sbml.org/sbml/symbols/time"> time </csymbol>
              <cn type="real"> 3.5 </cn>
            </apply>
          </math>
        </trigger>
        <listOfEventAssignments>
          <eventAssignment variable="X">
            <math xmlns="http://www.w3.org/1998/Math/MathML">
              <cn type="integer"> 0 </cn>
            </math>
          </eventAssignment>
        </listOfEventAssignments>
      </event>

      <event id="long_pulse_start" useValuesFromTriggerTime="true">
        <trigger initialValue="false" persistent="true">
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <geq/>
              <csymbol encoding="text" definitionURL="http://www.sbml.org/sbml/symbols/time"> time </csymbol>
              <cn type="integer"> 10 </cn>
            </apply>
          </math>
        </trigger>
        <listOfEventAssignments>
          <eventAssignment variable="X">
            <math xmlns="http://www.w3.org/1998/Math/MathML">
              <cn type="integer"> 1 </cn>
            </math>
          </eventAssignment>
        </listOfEventAssignments>
      </event>

      <event id="long_pulse_end" useValuesFromTriggerTime="true">
        <trigger initialValue="false" persistent="true">
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
              <geq/>
              <csymbol encoding="text" definitionURL="http://www.sbml.org/sbml/symbols/time"> time </csymbol>
              <cn type="integer"> 20 </cn>
            </apply>
          </math>
        </trigger>
        <listOfEventAssignments>
          <eventAssignment variable="X">
            <math xmlns="http://www.w3.org/1998/Math/MathML">
              <cn type="integer"> 0 </cn>
            </math>
          </eventAssignment>
        </listOfEventAssignments>
      </event>
    </listOfEvents>
  </model>
</sbml>